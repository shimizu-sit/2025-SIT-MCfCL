---
marp: true
theme: mytheme
class: lead
paginate: true
math: katex
title: コンピュータリテラシ応用 第6回授業資料
header: 第6回：Excel：いろいろな関数①
footer: Middle class of Computer Literacy | T.Shimizu © 2025
---

# コンピュータリテラシ応用
# 第6回：Excel いろいろな関数①
### IF関数 & データ数のカウント

情報学部 情報学科 情報メディア専攻
清水 哲也 ( shimizu@info.shonan-it.ac.jp )

---

# 今回の目標

- 目標：**`IF`** で条件分岐，**`COUNT/COUNTA/COUNTIF`** で件数集計ができる
- 今日やること
  - 論理式
  - 条件分岐：`IF`
  - 集計：`COUNT, COUNTA, COUNTBLANK, COUNTIF`

> Keywords: IF, Logical Test, COUNT, COUNTA, COUNTBLANK, COUNTIF, Criteria

---

# 授業内容

1. **タイピング練習（5分）**
   論理式の基礎
2. `IF`関数
3. カウント系（`COUNT/COUNTA/COUNTBLANK/COUNTIF`）
4. 課題


---

#  準備（ファイル）（ここは要修正）

* フォルダ：`CL_Apply/06_if_count`
* **ファイル名**：`学籍番号_氏名_06_IFCount.xlsx`
* 保存はこまめに：**Ctrl+S**（Mac：**⌘S**）

---

#  論理式（Logical Test）の基本

### 条件が成り立つかどうかを判定し，結果を`TRUE/FALSE`で返す式

- 例：`B2>=60` → B2セルの値がは60点以上なら`TRUE`, 未満なら`FALSE`
- 例：`C2="出席"` → C2セルの文字が「出席」なら`TRUE`, 違う場合は`FALSE`
- 比較演算子：`>` `>=` `<` `<=` `=` `<>`（≠）
- 文字の一致：`C2="出席"`（ダブルクォーテーションが必要）
- **注意**：全角/半角，空白，表記ゆれに弱い（"出席 "は別物）

---

# 比較演算子

<div style="font-size: 0.85em">

| 演算子 |       意味（何を比べるか）       |   例（式）   |        判定結果の例         |
| :----: | -------------------------------- | :----------: | --------------------------- |
|  `=`   | 左右が**等しい**                 |   `B2=60`    | B2が60なら`TRUE`            |
|  `<>`  | 左右が**等しくない**             | `C2<>"出席"` | C2が「出席」以外なら`TRUE`  |
|  `>`   | 左が右より**大きい**             |    `D2>0`    | D2が0より大きければ`TRUE`   |
|  `<`   | 左が右より**小さい**             |   `E2<100`   | E2が100より小さければ`TRUE` |
|  `>=`  | 左が右以上（**大きいか等しい**） |   `B2>=60`   | B2が60以上なら`TRUE`        |
|  `<=`  | 左が右以下（**小さいか等しい**） |   `F2<=G2`   | F2がG2以下なら`TRUE`        |

</div>


---

# `IF`関数（条件分岐）

**書式**：`=IF(論理式, 真の場合, 偽の場合)`

* 例1：合否判定
  `=IF(B2>=60, "合格", "不合格")`

![](./img/fig-01.png)

---

<!-- _class: no-footer -->

# `IF`関数（条件分岐）

**書式**：`=IF(論理式, 真の場合, 偽の場合)`

* 例2：閾値セルを使う（おすすめ）
  セル **＄B＄1** に合格点を置く → `=IF(B2>=$B$1, "合格", "不合格")`

![](./img/fig-02.png)


---

<!-- _class: no-footer -->

# `IF`関数（条件分岐）

**書式**：`=IF(論理式, 真の場合, 偽の場合)`

* 例3：空欄なら空欄(`""`)を返す
  `=IF(B2="", "", ?)`

![](./img/fig-03.png)

---

<!-- _class: no-footer -->

# `IF`関数（条件分岐）

**書式**：`=IF(論理式, 真の場合, 偽の場合)`

* 例3：空欄なら空欄(`""`)を返す → 空欄でない場合は通常の判定をする
  `=IF(B2="", "", IF(B2>=$B$1, "合格", "不合格"))`

![](./img/fig-04.png)

---

<!-- _class: no-footer -->

# `IF`関数（条件分岐）

**書式**：`=IF(論理式, 真の場合, 偽の場合)`

* 例3：空欄なら空欄(`""`)を返す → 空欄でない場合は通常の判定をする
  `=IF(B2="", "", IF(B2>=$B$1, "合格", "不合格"))`

![](./img/fig-05.png)

---

# カウント系の違い

* **COUNT(範囲)**：数値セルの**個数**(注意！数値そのものではない)
  例：`=COUNT(B3:B10)` → 点数が入っている件数
* **COUNTA(範囲)**：空白以外の**個数**（文字も数値も）
  例：`=COUNTA(B3:B10)` → 採点済みの件数（未受験も含む）
* **COUNTBLANK(範囲)**：**空白**の個数
  例：`=COUNTBLANK(B3:B10)` → 未採点の件数

> **0（ゼロ）**は空白ではありません（`COUNTBLANK`では数えない）

---

# カウント系の違い

* **COUNT(範囲)**：数値セルの**個数**(注意！数値そのものではない)
  例：`=COUNT(B3:B10)` → 点数が入っている件数

![w:800](./img/fig-06.png)

---

# カウント系の違い

* **COUNTBLANK(範囲)**：**空白**の個数
  例：`=COUNTBLANK(B3:B10)` → 未採点の件数

![w:800](./img/fig-07.png)

---

# カウント系の違い

* **COUNTA(範囲)**：空白以外の**個数**（文字も数値も）
  例：`=COUNTA(B3:B10)` → 採点済みの件数（未受験も含む）

![w:800](./img/fig-08.png)

---

# COUNTIF（条件で数える）

**書式**：`=COUNTIF(範囲, 条件)`

* 例1：60点以上の人数
  `=COUNTIF(B2:B11, ">=60")`
* 例2：閾値セルを使う（推奨）
  `=COUNTIF(B2:B11, ">="&$B$1)`
* 例3：文字一致（出席）
  `=COUNTIF(C2:C11, "出席")`

> 比較は **`">=60"`** のように**文字列**で書く／セル参照をつなぐときは **`&`** を使う。

---

<!-- _class: no-footer -->

# COUNTIF（条件で数える）

**書式**：`=COUNTIF(範囲, 条件)`

* 例1：60点以上の人数
  `=COUNTIF(B2:B11, ">=60")`

![w:800](./img/fig-09.png)

---

<!-- _class: no-footer -->

# COUNTIF（条件で数える）

**書式**：`=COUNTIF(範囲, 条件)`

* 例2：閾値セルを使う（推奨）
  `=COUNTIF(B2:B11, ">="&$B$1)`


![w:800](./img/fig-10.png)

---

<!-- _class: no-footer -->

# COUNTIF（条件で数える）

**書式**：`=COUNTIF(範囲, 条件)`

* 例3：文字一致（出席）
  `=COUNTIF(C2:C11, "出席")`

![w:800](./img/fig-11.png)

---

# サンプル表（練習用）

**シート名：成績**
A1:F1 に見出し：`出席, 氏名, 点数, 課題提出, 合否, メモ`

* A列 出席：`出席` / `欠席` を含む混在データ
* C列 点数：0〜100 の整数
* D列 課題提出：`提出済み` / `未提出`
* E列 合否：**IFで判定**（B1=合格点）

> この表を使って、IFとCOUNT系の式を入れていきます。

---

# 実演①：IFで合否

1. **B1** に合格点（例：60）を入力
2. **E2** に：`=IF(C2>=$B$1, "合格", "不合格")`
3. 下へオートフィル

**仕上げ**：E列を中央揃え／合格は緑，それ以外は黒（色分けは任意）

---

# 実演②：カウント系で集計

* 合計件数：`=COUNTA(B2:B11)`
* 未提出の件数：`=COUNTBLANK(D2:D11)` または `=COUNTIF(D2:D11, "未提出")`
* 60点以上の人数：`=COUNTIF(C2:C11, ">="&$B$1)`
* 出席の回数：`=COUNTIF(A2:A11, "出席")`

> まとめセルは表の**右上**や**下**に作ると見やすい。

---

# 演習（提出対象）

**提出ファイル**：`学籍番号_氏名_06_IFCount.xlsx`
**テンプレ**：`06_IFCount_template.xlsx`（Moodle配布予定）

## シート1：成績

* B1に合格点（60）を入力
* E列に **IF** で合否（空欄対策は任意）
* 体裁（見出しの塗り・罫線・中央揃え）

---

# 演習（提出対象）

## シート2：集計

* `COUNTA`：氏名の件数
* `COUNTBLANK`：課題「未入力（空欄）」の件数
* `COUNTIF`：60点以上の人数／出席の回数
* まとめ表を**2×3**程度で作成

---

# 演習（提出対象）

## シート3：オプション

* テキスト条件の`COUNTIF`で「*提出*」を数える
* **任意**：`COUNTIFS`で「出席 かつ 60点以上」を数えてみる

---

# よくあるつまずき（対処）

* **"60" を数値にし忘れ** → 引用符を外す／セル参照にする
* **COUNTとCOUNTAの混同** → COUNT=数値だけ、COUNTA=空白以外
* **空欄と"未提出"** → 空欄は`COUNTBLANK`、文字は`COUNTIF("未提出")`
* **全角/半角や空白** → `TRIM`等で前後スペース除去（今回は意識でOK）

---

# 参考（覚えると便利）

* **F4**：`$` の切替（相対/絶対/混合）
* **Ctrl+`**：式の表示切替（確認用）
* **Alt+Enter**：セル内改行（注記に便利）

---

# まとめ

* IF：`=IF(テスト, 真, 偽)` を覚える
* COUNT系：**何を数えるか**で `COUNT / COUNTA / COUNTBLANK / COUNTIF` を使い分け
* 条件は **"">=60""**、セル参照は **`">="&$B$1`** が安全
