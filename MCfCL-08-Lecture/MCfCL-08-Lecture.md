---
marp: true
theme: mytheme
class: lead
paginate: true
math: katex
title: コンピュータリテラシ応用 第8回授業資料
header: 第8回：Excel：いろいろな関数③
footer: Middle class of Computer Literacy | T.Shimizu © 2025
---

# コンピュータリテラシ応用
# 第8回：Excel いろいろな関数③
### 数式や関数の練習

情報学部 情報学科 情報メディア専攻
清水 哲也 ( shimizu@info.shonan-it.ac.jp )

---

# 今回の目標

- 目標：**VLOOKUPの基本**と**完全一致**，**近似一致**を使い分け、`#N/A`への対処ができる
- 今日やること
  - VLOOKUPの考え方
  - 完全一致
  - 近似一致
  - エラー対処

> Keywords: VLOOKUP, 完全一致, 近似一致, 列番号, IFERROR, 絶対参照

---

# 授業内容

1. **タイピング練習（5分）**
2. ウォームアップ：基本集計4種の復習
3. **`SUMIF`**（条件付き合計）
4. **丸め3兄弟**：`ROUND` / `ROUNDDOWN` / `RfOUNDUP`
5. **文字関数**：`LEFT` / `MID` / `RIGHT`

---

---

---

# 第8回

## いろいろな関数③（指定版）

* 担当：清水
* 本日の関数：

  * **復習**：`SUM, AVERAGE, MAX, MIN`
  * **新規**：`SUMIF`、`ROUND / ROUNDDOWN / ROUNDUP`、`LEFT / MID / RIGHT`
* 目標：**合計・集計・丸め・文字抽出**を適切に使い、表を壊さずコピーできる

---

## 1) 準備（ファイル）

* フォルダ：`CL_Apply/08_practice`
* **ファイル名**：`学籍番号_氏名_08_Practice.xlsx`
* 配布テンプレ：`08_Practice_template.xlsx`（Moodle予定）

---

## 2) 復習：基本集計4種（表の上や右にまとめセル）

* **SUM(範囲)**：合計
* **AVERAGE(範囲)**：平均
* **MAX(範囲)**：最大
* **MIN(範囲)**：最小

> 使い方のコツ：範囲を**表から独立**させる（表の外に集計セル）。

---

## 3) SUMIF（条件付き合計）

**書式**：`=SUMIF(条件範囲, 条件, 合計範囲)`

* 例1：**カテゴリが「文具」**の合計
  `=SUMIF(C2:C101, "文具", F2:F101)`
* 例2：**日付が2025/10/01**の合計
  `=SUMIF(A2:A101, DATE(2025,10,1), F2:F101)`
* 例3：**金額が1,000以上**の合計（条件は**文字列**で書く）
  `=SUMIF(F2:F101, ">=1000", F2:F101)`

> ポイント：
>
> * **条件は文字列**（`">=1000"`）。セル参照と組み合わせるときは `"<="&G1`。
> * 条件範囲と合計範囲は**同じ行数**。
> * 複数条件は本講では扱いません（`SUMIFS` は次回以降）。

---

## 4) 丸め：ROUND / ROUNDDOWN / ROUNDUP

**共通書式**：`=関数(数値, 桁数)`

* **桁数**の意味：

  * `2` → 小数点**第2位まで**
  * `0` → **整数**に丸め
  * `-1` → **10の位**、`-2` → **100の位**

|    元の値 | 桁数 | ROUND |      ROUNDDOWN |           ROUNDUP |
| -----: | -: | ----: | -------------: | ----------------: |
| 12.345 |  2 | 12.35 |          12.34 |             12.35 |
| 12.345 |  0 |    12 |             12 |                13 |
|    155 | -1 |   160 |            150 |               160 |
| -12.34 |  1 | -12.3 | -12.3（**0方向**） | -12.4（**0から離れる**） |

> 使い分け：**請求額**は`ROUND`、**切捨て端数**は`ROUNDDOWN`、**切上げ送料**は`ROUNDUP` など。

---

## 5) 文字関数：LEFT / MID / RIGHT

* **LEFT(文字列, 文字数)**：左から取り出す
* **MID(文字列, 開始位置, 文字数)**：途中から取り出す
* **RIGHT(文字列, 文字数)**：右から取り出す

**例：コード `P-2025-00123` から抽出**

* 種別：`=LEFT(A2,1)` → `P`
* 年：`=MID(A2,3,4)` → `2025`
* 連番：`=RIGHT(A2,5)` → `00123`

> 注意：**全角/半角**も1文字として数える。桁が可変なら `FIND/SEARCH` で位置を探す（今回は紹介のみ）。

---

## 6) ハンズオン設計（各シート）

**A_集計**（復習）

* データ：`金額`列の **SUM/AVERAGE/MAX/MIN** を作成

**B_SUMIF**（新規）

* 例：`カテゴリ` が `文具` の合計、`日付` がセル `G1` の日の合計、`金額>=G2` の合計

**C_丸め**（新規）

* 小数価格を **円単位**に `ROUND(...,0)`、**10円単位**に `ROUNDDOWN(...,-1)`、**100円単位切上げ**に `ROUNDUP(...,-2)`

**D_文字**（新規）

* `P-2025-00123` 形式から **種別/年/連番** を分解（LEFT/MID/RIGHT）

---

## 7) 総合演習（提出対象）

**提出ファイル**：`学籍番号_氏名_08_Practice.xlsx`
**テンプレ**：`08_Practice_template.xlsx`

### データ（シート：Data）

`日付, 伝票No, カテゴリ, 商品コード, 単価（小数）, 数量, 金額(空欄)` がある想定

### 目標（4本立て）

1. **金額**：`=単価×数量` を作成し、**ROUND(...,0)** で**整数円**に丸め
2. **カテゴリ別合計**：別表で **SUMIF** により `カテゴリ` ごとの**合計金額**
3. **しきい値合計**：セル `G1` の値以上の **SUMIF("\u003e="&G1)**
4. **コード分解**：`商品コード` から **LEFT/MID/RIGHT** で **種別/年/連番** 列を作る

> 仕上げ：桁区切り、見出しの塗り、印刷設定（A4/1ページ）

---

## 8) 配点（例）

* A_集計（10点）
* B_SUMIF（30点）
* C_丸め（30点）
* D_文字（20点）
* 体裁・印刷（10点）

> 合計100点。**+5点**：丸め桁をセル参照で切替（`ROUND(金額, $H$1)` など）

---

## 9) ミニルーブリック（授業内）

| 観点    | C（基準）             | B（+）       | A（++）       |
| ----- | ----------------- | ---------- | ----------- |
| 基本集計  | 4種を正しく計算          | セル配置が読みやすい | 範囲が増えても壊れない |
| SUMIF | 条件と範囲が対応          | セル参照で条件化   | まとめ表の設計が良い  |
| 丸め    | 3種を使い分け           | 桁数が適切      | 参照セルで切替可能   |
| 文字    | LEFT/MID/RIGHTが正確 | 列名と注記が明確   | 可変桁への応用の発想  |
| 体裁    | 罫線/書式/印刷          | 列幅・配置が整然   | 可読性・説明の工夫   |

---

## 10) よくあるつまずき（対処）

* **SUMIFが0**：条件が文字列でない／全半角違い → `"文具"`、`TRIM`で空白削除
* **丸め桁の勘違い**：`-1`は10の位、`-2`は100の位
* **ROUNDUP/DOWNの向き**：`UP=0から離れる / DOWN=0に近づく`
* **文字抽出の位置**：`MID(開始位置は1始まり)`、桁ミスに注意

---

## 11) 参考ショートカット

* **F2**：セルの式を確認
* **F4**：`$` 切替（参照固定）
* **Ctrl+`**：式の表示切替
* **Ctrl+1**：書式設定

---

## まとめ

* 基本集計は**復習**、本日の柱は **SUMIF / 丸め / 文字抽出**
* 条件は**文字列**、丸めは**桁数の解釈**、文字は**桁の数え方**に注意
* **1つ作って下へコピー → 壊れないか確認**が基本動作

---

# 次回まで

* 自分のデータで SUMIF の条件を**セル参照**に置き換えてみる
* 丸め桁を `-1/-2` で変えて印刷の見栄えを比較
* 質問はMoodleのQ&Aへ
