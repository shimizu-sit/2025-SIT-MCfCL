---
marp: true
theme: mytheme
class: lead
paginate: true
math: katex
title: コンピュータリテラシ応用 第8回授業資料
header: 第8回：Excel：いろいろな関数③
footer: Middle class of Computer Literacy | T.Shimizu © 2025
---

# コンピュータリテラシ応用
# 第8回：Excel いろいろな関数③
### 数式や関数の練習

情報学部 情報学科 情報メディア専攻
清水 哲也 ( shimizu@info.shonan-it.ac.jp )

---

# 今回の目標

- 目標：**合計・集計・丸め・文字抽出**を適切に使い、表を壊さずコピーできる
- 今日やること
  - 基本集計関数`SUM, AVERAGE, MAX, MIN`
  - 条件を付き合計`SUMIF`
  - 丸め関数`ROUND` / `ROUNDDOWN` / `RfOUNDUP`
  - 文字関数`LEFT` / `MID` / `RIGHT`

> Keywords: SUM, AVERAGE, MAX, MIN, SUMIF, ROUND, ROUNDUP, ROUNDDOWN, LEFT, MID, RIGHT

---

# 授業内容

1. **タイピング練習（5分）**
2. 基本集計4種の復習
3. **`SUMIF`**（条件付き合計）
4. **丸め関数**：`ROUND` / `ROUNDDOWN` / `RfOUNDUP`
5. **文字関数**：`LEFT` / `MID` / `RIGHT`

---

# 準備（ファイル）

- Moodleから「08_Function_sample.xlsx」をダウンロードする

---

# 基本集計4種

- シート：**注文履歴**
- 金額計算：`I列 = G列 × H列`
- G列「単価」，I列「金額」：**桁区切り**，**通貨記号「¥」**

![](./img/fig-01.png)

---

# 基本集計4種

* **SUM(範囲)**：合計
* **AVERAGE(範囲)**：平均
* **MAX(範囲)**：最大
* **MIN(範囲)**：最小

---

# 基本集計4種

- シート：**基本集計**

![w:600](./img/fig-02.png)

---

# 基本集計4種

- シート：**基本集計**
- **総売上**：「金額」の総額，桁区切り，通貨記号「¥」
- **平均単価**：「単価」の平均，桁区切り，通貨記号「¥」
- **平均購入金額**：「金額」の平均，小数点第2位，桁区切り，通貨記号「¥」
- **最大数量**：「数量」の最大金額
- **最小金額**：「金額」の最少額，桁区切り，通貨記号「¥」

---

# SUMIF（条件付き合計）

**書式**：`=SUMIF(条件範囲, 条件, 合計範囲)`

1. **条件範囲**内で**条件判定**をする
2. 条件に合う行を確認する
3. **合計範囲**内で条件に合う行の値を**合計**する

---

# SUMIF（条件付き合計）

- `sumif`を使って**営業部の勤務日数合計**を求める

![h:450](./img/fig-03.png)

---

# SUMIF（条件付き合計）

- **条件範囲**：対象が「**営業部**」なのでD列「部署」
- **条件**：対象が「**営業部**」なので「`"営業"`」

![h:400](./img/fig-04.png)

---

# SUMIF（条件付き合計）

- **合計範囲**：対象が「**勤務日数合計**」なのでE列「勤務日数」

![h:400](./img/fig-05.png)

---

# SUMIF（条件付き合計）

- `sumif`を使って**営業部の勤務日数合計**を求める
  - 条件範囲：**D列「部署」**
  - 条件：**「営業」**
  - 合計範囲：**E列「勤務日数」**

<div style="text-align:center;font-size:2.0em">

` =SUMIF(D3:D12,"営業",E3:E12)`

</div>


---

# SUMIF（条件付き合計）

**書式**：`=SUMIF(条件範囲, 条件, 合計範囲)`

* 例1： **商品名が「スマートフォン」** の合計
  条件範囲：条件：
* 例2：**日付が2025/10/03**の合計
  `=SUMIF(A2:A101, DATE(2025,10,1), F2:F101)`
* 例3：**金額が4,000以上**の合計（条件は**文字列**で書く）
  `=SUMIF(F2:F101, ">=1000", F2:F101)`

> ポイント：
>
> * **条件は文字列**（`">=1000"`）。セル参照と組み合わせるときは `"<="&G1`。
> * 条件範囲と合計範囲は**同じ行数**。
> * 複数条件は本講では扱いません（`SUMIFS` は次回以降）。

---

## 4) 丸め：ROUND / ROUNDDOWN / ROUNDUP

**共通書式**：`=関数(数値, 桁数)`

* **桁数**の意味：

  * `2` → 小数点**第2位まで**
  * `0` → **整数**に丸め
  * `-1` → **10の位**、`-2` → **100の位**

|    元の値 | 桁数 | ROUND |      ROUNDDOWN |           ROUNDUP |
| -----: | -: | ----: | -------------: | ----------------: |
| 12.345 |  2 | 12.35 |          12.34 |             12.35 |
| 12.345 |  0 |    12 |             12 |                13 |
|    155 | -1 |   160 |            150 |               160 |
| -12.34 |  1 | -12.3 | -12.3（**0方向**） | -12.4（**0から離れる**） |

> 使い分け：**請求額**は`ROUND`、**切捨て端数**は`ROUNDDOWN`、**切上げ送料**は`ROUNDUP` など。

---

## 5) 文字関数：LEFT / MID / RIGHT

* **LEFT(文字列, 文字数)**：左から取り出す
* **MID(文字列, 開始位置, 文字数)**：途中から取り出す
* **RIGHT(文字列, 文字数)**：右から取り出す

**例：コード `P-2025-00123` から抽出**

* 種別：`=LEFT(A2,1)` → `P`
* 年：`=MID(A2,3,4)` → `2025`
* 連番：`=RIGHT(A2,5)` → `00123`

> 注意：**全角/半角**も1文字として数える。桁が可変なら `FIND/SEARCH` で位置を探す（今回は紹介のみ）。

---

## 6) ハンズオン設計（各シート）

**A_集計**（復習）

* データ：`金額`列の **SUM/AVERAGE/MAX/MIN** を作成

**B_SUMIF**（新規）

* 例：`カテゴリ` が `文具` の合計、`日付` がセル `G1` の日の合計、`金額>=G2` の合計

**C_丸め**（新規）

* 小数価格を **円単位**に `ROUND(...,0)`、**10円単位**に `ROUNDDOWN(...,-1)`、**100円単位切上げ**に `ROUNDUP(...,-2)`

**D_文字**（新規）

* `P-2025-00123` 形式から **種別/年/連番** を分解（LEFT/MID/RIGHT）

---

## 7) 総合演習（提出対象）

**提出ファイル**：`学籍番号_氏名_08_Practice.xlsx`
**テンプレ**：`08_Practice_template.xlsx`

### データ（シート：Data）

`日付, 伝票No, カテゴリ, 商品コード, 単価（小数）, 数量, 金額(空欄)` がある想定

### 目標（4本立て）

1. **金額**：`=単価×数量` を作成し、**ROUND(...,0)** で**整数円**に丸め
2. **カテゴリ別合計**：別表で **SUMIF** により `カテゴリ` ごとの**合計金額**
3. **しきい値合計**：セル `G1` の値以上の **SUMIF("\u003e="&G1)**
4. **コード分解**：`商品コード` から **LEFT/MID/RIGHT** で **種別/年/連番** 列を作る

> 仕上げ：桁区切り、見出しの塗り、印刷設定（A4/1ページ）

---

## 8) 配点（例）

* A_集計（10点）
* B_SUMIF（30点）
* C_丸め（30点）
* D_文字（20点）
* 体裁・印刷（10点）

> 合計100点。**+5点**：丸め桁をセル参照で切替（`ROUND(金額, $H$1)` など）

---

## 10) よくあるつまずき（対処）

* **SUMIFが0**：条件が文字列でない／全半角違い → `"文具"`、`TRIM`で空白削除
* **丸め桁の勘違い**：`-1`は10の位、`-2`は100の位
* **ROUNDUP/DOWNの向き**：`UP=0から離れる / DOWN=0に近づく`
* **文字抽出の位置**：`MID(開始位置は1始まり)`、桁ミスに注意

---

## 11) 参考ショートカット

* **F2**：セルの式を確認
* **F4**：`$` 切替（参照固定）
* **Ctrl+`**：式の表示切替
* **Ctrl+1**：書式設定

---

## まとめ

* 基本集計は**復習**、本日の柱は **SUMIF / 丸め / 文字抽出**
* 条件は**文字列**、丸めは**桁数の解釈**、文字は**桁の数え方**に注意
* **1つ作って下へコピー → 壊れないか確認**が基本動作
