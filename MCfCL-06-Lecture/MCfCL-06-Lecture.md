---
marp: true
theme: mytheme
class: lead
paginate: true
math: katex
title: コンピュータリテラシ応用 第5回授業資料
header: 第5回：Excel：相対参照と絶対参照
footer: Middle class of Computer Literacy | T.Shimizu © 2025
---

# コンピュータリテラシ応用
# 第5回：Excel
### 相対参照と絶対参照

情報学部 情報学科 情報メディア専攻
清水 哲也 ( shimizu@info.shonan-it.ac.jp )

---

# 今回の目標

- 目標：**相対 / 絶対 / 複合**参照を使い分け，式を**正しくコピー**できる
- 今日やること
  - 参照の仕組み
  - `F4`キー切替
  - 複合参照

> Keywords: Relative, Absolute, Mixed, F4, $A$1, A$1, $A1

---

# 授業内容

1. **タイピング練習（5分）**
2. 参照の考え方
3. F4で切り替え
4. 例①：税込金額（相対＋絶対）
5. 例②：一律割引（相対＋絶対）
6. 例③：九九表で複合参照

---

# 準備（ファイル）

- Excelを起動して「**空白のブック**」から空のExcelを開く

![](./img/fig-00.png)

---

# 参照とは（要点）

- **相対参照**：コピー先に合わせて**動く**参照（例：`D2*E2`）
- **絶対参照**：どこへコピーしても**固定**（例：`$B$1`）
- **複合参照**：列または行だけ固定（例：`$B2` / `B$2`）

> `$` が付く場所＝**動かしたくない**場所。

---

# 参照とは（相対参照）

- **相対参照**：コピー先に合わせて**動く**参照（例：`D2*E2`）

![](./img/fig-01.png)

---

# 参照とは（絶対参照）

- **絶対参照**：どこへコピーしても**固定**（例：`$B$1`））

![](./img/fig-02.png)


---

# 参照とは（複合参照）

- **複合参照**：列または行だけ固定（例：`$B2` / `B$2`）

![](./img/fig-03.png)


---

# `F4`キーで参照を切り替える

- 数式内でセル参照を選択 → **F4** を押すと **相対参照→絶対参照→複合参照(行)→複合参照(列)→相対参照** と切替

![w:800](./img/fig-04.png)

最初の状態(`B2`) → `F4`キー1回目(`$B$2`) → `F4`キー2回目(`B$2`) →
→ `F4`キー3回目(`$B2`) → `F4`キー4回目(`B2`)

---

# 課題準備（ファイル）

- MoodleからExcelファイルをダウンロード
- **ファイル名**：`学籍番号_氏名_05_Ref.xlsx`
- 保存はこまめに：**Ctrl+S**

---

# 課題①：税込金額（相対参照＋絶対参照）

**シート名：税込**

![](./img/fig-05.png)

---

# 課題①：税込金額（相対参照＋絶対参照）

- **A列**：`A2`セルに今日の日付を入力（`2025/10/21`, 幅を調整），オートフィル
- **B列**：商品名（**食べ物**）を自由に入力（例：りんご）
- **C列**：商品名を参考に相場の単価を入力（例：りんご→230円）
- **D列**：数量は`1`から`15`までの数字を入力
- **E列**：単価ｘ数量を数式で計算する（例：`=C2 * D2`）
- **F列**：金額（E列）に税率をかけた税込み価格を数式で計算する
- **税率**は**絶対参照**を利用してください
- 金額列は**桁区切り**，税込列は**通貨**表示

---

# 課題②：一律割引（相対参照＋絶対参照）

**シート名：割引**

![](./img/fig-06.png)

---

# 課題②：一律割引（相対参照＋絶対参照）

- **A列**：`A2`セルに今日の日付を入力（`2025/10/21`, 幅を調整），オートフィル
- **B列**：商品名（**文房具**）を自由に入力（例：ボールペン）
- **C列**：商品名を参考に相場の単価を入力（例：ボールペン→230円）
- **D列**：数量は`1`から`15`までの数字を入力
- **E列**：単価ｘ数量を数式で計算する（例：`=C2 * D2`）
- **F列**：金額（E列）から割引率分を引いた割引後金額を数式で計算する
- **割引率**は**絶対参照**を利用してください
- 金額列は**桁区切り**，税込列は**通貨**表示

---

# 課題③：九九表で複合参照（列固定 / 行固定）

**シート名：九九**

![](./img/fig-07.png)

---

# 課題③：九九表で複合参照（列固定 / 行固定）

- **B2** に数式：`=$A2*B$1`
  - **`$A2`**：**列A固定**（A列の段が固定）
  - **`B$1`**：**行1固定**（1行目の段が固定）
- **B2** を **右と下**にオートフィル → きれいな九九表が完成

---

# よくあるつまずき（対処）

- **税込が行ごとにバラバラ** → `$B$1` が `$` なしになっていないか
- **九九が斜めに同じ値** → 複合参照の `$` の位置が逆
- **数値にならない** → 文字列（左寄り）に注意、先頭の `'` を削除
- **%表示が変** → 値を 0.1 にして **パーセンテージ表示** を適用

---

# 課題

- **提出先**：Moodle「[第5回 課題](https://moodle2025.shonan-it.ac.jp/mod/assign/view.php?id=40829)」
- **提出物**：`学籍番号_氏名_05_Ref.xlsx`
- **提出期限**：授業終了時刻まで

---

# 参考操作（覚えると楽）

- **F2**：アクティブセルの式を編集（参照の色で追跡）
- **Ctrl+Enter**：同時入力／同時確定
- **Ctrl+`**：式の表示/非表示切替（グレイブ）
- **Ctrl+1**：セルの書式設定ダイアログ

---

# まとめ

- **相対**＝動く、**絶対**＝固定、**複合**＝片方だけ固定
- **F4**で素早く切替 → **コピーして確認**が基本動作
- 税率・割引率・見出しで**固定参照**を使うと、ミスを減らせる
